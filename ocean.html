<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ocean Insight: AI-Powered Argo Explorer</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      #map {
        height: 100%;
      }
      .chat-message.user {
        background-color: #e3f2fd;
      }
      .chat-message.bot {
        background-color: #f5f5f5;
      }
      .time-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #0ea5e9;
        cursor: pointer;
      }
      .float-marker {
        background-color: #0ea5e9;
        border-radius: 50%;
        width: 12px;
        height: 12px;
        border: 2px solid white;
      }
      .float-marker.selected {
        background-color: #ef4444;
        width: 16px;
        height: 16px;
      }
    </style>
  </head>
  <body class="bg-gradient-to-b from-blue-50 to-cyan-50 min-h-screen">
    <!-- Landing Page -->
    <div
      id="landing"
      class="fixed inset-0 bg-blue-900 flex flex-col items-center justify-center z-50 transition-opacity duration-500"
    >
      <div class="text-center px-6 max-w-4xl" data-aos="fade-up">
        <h1 class="text-5xl font-bold text-white mb-4">Ocean Insight</h1>
        <h2 class="text-2xl text-blue-200 mb-8">AI-Powered Argo Explorer</h2>
        <p class="text-blue-100 mb-10 text-lg">
          Transform ARGO NetCDF ocean data into interactive visual insights with
          our intelligent analysis platform.
        </p>
        <button
          onclick="startDemo()"
          class="bg-white text-blue-900 px-8 py-3 rounded-full font-bold hover:bg-blue-100 transition-all flex items-center mx-auto"
        >
          <i data-feather="play" class="mr-2"></i> Launch Demo
        </button>
      </div>
      <div class="absolute bottom-4 text-blue-300">
        <p>Smart India Hackathon 2024</p>
      </div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden h-screen flex flex-col">
      <!-- Header -->
      <header
        class="bg-blue-900 text-white p-4 flex justify-between items-center shadow-md"
      >
        <div class="flex items-center">
          <i data-feather="compass" class="mr-2"></i>
          <h1 class="text-xl font-bold">Ocean Insight</h1>
        </div>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <select
              id="mode-selector"
              class="bg-blue-800 text-white px-3 py-1 rounded-md text-sm"
            >
              <option value="scientist">Scientist Mode</option>
              <option value="policy">Policy Maker Mode</option>
              <option value="student">Student Mode</option>
            </select>
          </div>
          <button
            id="upload-btn"
            class="bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded-md text-sm flex items-center"
          >
            <i data-feather="upload" class="mr-1 w-4 h-4"></i> Upload NetCDF
          </button>
          <input type="file" id="file-input" class="hidden" accept=".nc" />
        </div>
      </header>

      <!-- Main Content -->
      <div class="flex flex-1 overflow-hidden">
        <!-- Map Container -->
        <div class="flex-1 relative">
          <div id="map" class="h-full w-full"></div>

          <!-- Time Slider -->
          <div
            class="absolute bottom-4 left-4 right-4 bg-white p-3 rounded-lg shadow-lg z-10"
          >
            <div class="flex items-center mb-2">
              <i data-feather="calendar" class="mr-2 text-blue-600"></i>
              <span id="time-label" class="text-sm font-medium">June 2024</span>
            </div>
            <input
              type="range"
              min="0"
              max="11"
              value="5"
              class="w-full time-slider"
              id="time-slider"
            />
            <div class="flex justify-between text-xs text-gray-600 mt-1">
              <span>Jan 2024</span>
              <span>Dec 2024</span>
            </div>
          </div>

          <!-- Region Selector -->
          <div
            class="absolute top-4 left-4 bg-white p-2 rounded-lg shadow-lg z-10"
          >
            <button id="region-select-btn" class="flex items-center text-sm">
              <i data-feather="map" class="mr-1 text-blue-600"></i> Select
              Region
            </button>
          </div>

          <!-- Comparison Controls -->
          <div
            id="comparison-controls"
            class="absolute top-4 right-4 bg-white p-2 rounded-lg shadow-lg z-10 hidden"
          >
            <div class="flex items-center space-x-2">
              <span class="text-sm font-medium">Comparing:</span>
              <span
                id="compare-count"
                class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"
                >0/2</span
              >
              <button
                id="compare-btn"
                class="bg-blue-600 text-white px-2 py-1 rounded text-sm hover:bg-blue-700 disabled:opacity-50"
                disabled
              >
                Compare
              </button>
            </div>
          </div>
        </div>

        <!-- Chat & Visualization Panel -->
        <div class="w-96 bg-white border-l border-gray-200 flex flex-col">
          <!-- Chat Header -->
          <div class="p-4 border-b border-gray-200 flex items-center">
            <i data-feather="message-square" class="mr-2 text-blue-600"></i>
            <h2 class="font-medium">Ocean Data Assistant</h2>
          </div>

          <!-- Chat Messages -->
          <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4">
            <div class="chat-message bot rounded-lg p-3">
              <p>
                Hello! I'm your Ocean Data Assistant. Ask me questions about
                ARGO float data or upload your own NetCDF file to analyze.
              </p>
              <p class="mt-2 text-sm text-gray-600">
                Try: "Show temperature at 100m in Arabian Sea" or "Compare
                salinity between two floats"
              </p>
            </div>
          </div>

          <!-- Chat Input -->
          <div class="p-4 border-t border-gray-200">
            <div class="flex">
              <input
                id="chat-input"
                type="text"
                placeholder="Ask about ocean data..."
                class="flex-1 border border-gray-300 rounded-l-md px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500"
              />
              <button
                id="send-btn"
                class="bg-blue-600 text-white px-4 py-2 rounded-r-md hover:bg-blue-700"
              >
                <i data-feather="send"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Comparison Panel (Hidden by default) -->
      <div
        id="comparison-panel"
        class="hidden bg-white border-t border-gray-200 h-64"
      >
        <div
          class="p-3 border-b border-gray-200 flex justify-between items-center"
        >
          <h3 class="font-medium">Comparison Dashboard</h3>
          <button
            id="close-comparison"
            class="text-gray-500 hover:text-gray-700"
          >
            <i data-feather="x"></i>
          </button>
        </div>
        <div class="flex h-full">
          <div class="flex-1 p-4 border-r border-gray-200">
            <h4 class="text-sm font-medium mb-2" id="compare-title-1">
              Float 1
            </h4>
            <div id="compare-chart-1" class="h-48"></div>
          </div>
          <div class="flex-1 p-4">
            <h4 class="text-sm font-medium mb-2" id="compare-title-2">
              Float 2
            </h4>
            <div id="compare-chart-2" class="h-48"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initialize AOS and Feather Icons
      AOS.init();
      feather.replace();

      // Landing page transition
      function startDemo() {
        document.getElementById("landing").classList.add("opacity-0");
        setTimeout(() => {
          document.getElementById("landing").classList.add("hidden");
          document.getElementById("app").classList.remove("hidden");
          initMap();
        }, 500);
      }

      // Fetch ARGO float data from backend
      let floats = [];
      let selectedFloats = [];
      let map;
      let markers = [];

      // Helper: Format month/year for slider
      function getMonthYear(index) {
        const months = [
          "Jan",
          "Feb",
          "Mar",
          "Apr",
          "May",
          "Jun",
          "Jul",
          "Aug",
          "Sep",
          "Oct",
          "Nov",
          "Dec",
        ];
        return `${months[index]} 2024`;
      }

      // Fetch floats for a given month (index: 0-11)
      async function fetchFloatsByMonth(monthIndex) {
        // Example API: /floats?year=2024&month=MM
        const year = 2024;
        const month = String(monthIndex + 1).padStart(2, "0");
        try {
          const res = await fetch(`/floats?year=${year}&month=${month}`);
          if (!res.ok) throw new Error("Failed to fetch floats");
          floats = await res.json();
        } catch (e) {
          floats = [];
        }
      }

      // Fetch trajectory for a float
      async function fetchTrajectory(floatId) {
        // Example API: /floats/{floatId}/trajectory
        try {
          const res = await fetch(`/floats/${floatId}/trajectory`);
          if (!res.ok) throw new Error("Failed to fetch trajectory");
          return await res.json();
        } catch (e) {
          return null;
        }
      }

      // Selected floats for comparison
      // (already declared above)

      // Initialize the map
      function initMap() {
        map = L.map("map").setView([15, 80], 4);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution:
            '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        }).addTo(map);

        // Initial marker load for current slider month
        updateMarkersForMonth(
          parseInt(document.getElementById("time-slider").value)
        );
      }

      // Update markers for selected month
      async function updateMarkersForMonth(monthIndex) {
        await fetchFloatsByMonth(monthIndex);
        // Remove old markers
        markers.forEach((m) => map.removeLayer(m));
        markers = [];
        // Add new markers
        floats.forEach((float) => {
          const marker = L.marker([float.lat, float.lon], {
            icon: L.divIcon({
              className: "float-marker",
              html: "",
              iconSize: [12, 12],
            }),
          }).addTo(map);
          marker.bindPopup(`
            <div class="p-2">
              <h4 class="font-bold">Float ${float.id}</h4>
              <p class="text-sm">Date: ${float.date}</p>
              <p class="text-sm">Depth: ${float.depthRange}</p>
              <p class="text-sm">Variables: ${float.variables?.join(", ")}</p>
              <p class="text-sm">Region: ${float.region}</p>
              <button onclick="selectFloat('${
                float.id
              }')" class="mt-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded hover:bg-blue-200">Compare</button>
              <button onclick="showTrajectory('${
                float.id
              }')" class="mt-2 ml-2 bg-cyan-100 text-cyan-800 text-xs px-2 py-1 rounded hover:bg-cyan-200">Show Trajectory</button>
            </div>
          `);
          marker.floatData = float;
          markers.push(marker);
        });
      }

      // Show comparison controls when region select is clicked
      document
        .getElementById("region-select-btn")
        .addEventListener("click", () => {
          document
            .getElementById("comparison-controls")
            .classList.toggle("hidden");
        });

      // Time slider functionality
      const timeSlider = document.getElementById("time-slider");
      const timeLabel = document.getElementById("time-label");
      timeSlider.addEventListener("input", async () => {
        const monthIndex = parseInt(timeSlider.value);
        timeLabel.textContent = getMonthYear(monthIndex);
        await updateMarkersForMonth(monthIndex);
      });

      // Chat functionality
      const chatInput = document.getElementById("chat-input");
      const sendBtn = document.getElementById("send-btn");
      const chatMessages = document.getElementById("chat-messages");

      function sendMessage() {
        const message = chatInput.value.trim();
        if (!message) return;

        // Add user message
        const userMsg = document.createElement("div");
        userMsg.className = "chat-message user rounded-lg p-3";
        userMsg.innerHTML = `<p>${message}</p>`;
        chatMessages.appendChild(userMsg);

        // Clear input
        chatInput.value = "";

        // Scroll to bottom
        chatMessages.scrollTop = chatMessages.scrollHeight;

        // Process query (simplified for demo)
        setTimeout(() => {
          const botMsg = document.createElement("div");
          botMsg.className = "chat-message bot rounded-lg p-3";

          if (message.toLowerCase().includes("temperature")) {
            const depth = message.match(/\d+/)?.[0] || "100";
            const region = message.toLowerCase().includes("arabian")
              ? "Arabian Sea"
              : message.toLowerCase().includes("bengal")
              ? "Bay of Bengal"
              : "selected region";

            botMsg.innerHTML = `
                            <p>Showing temperature at ${depth}m in ${region}:</p>
                            <div class="mt-2 h-40" id="temp-chart"></div>
                            <button onclick="explainChart('temp-chart')" class="mt-2 text-blue-600 text-sm flex items-center">
                                <i data-feather="info" class="mr-1 w-4 h-4"></i> Explain this chart
                            </button>
                        `;

            chatMessages.appendChild(botMsg);
            feather.replace();

            // Render chart
            setTimeout(() => {
              renderTempChart("temp-chart", depth, region);
            }, 100);
          } else if (message.toLowerCase().includes("salinity")) {
            const depth = message.match(/\d+/)?.[0] || "100";
            const region = message.toLowerCase().includes("arabian")
              ? "Arabian Sea"
              : message.toLowerCase().includes("bengal")
              ? "Bay of Bengal"
              : "selected region";

            botMsg.innerHTML = `
                            <p>Showing salinity at ${depth}m in ${region}:</p>
                            <div class="mt-2 h-40" id="salinity-chart"></div>
                            <button onclick="explainChart('salinity-chart')" class="mt-2 text-blue-600 text-sm flex items-center">
                                <i data-feather="info" class="mr-1 w-4 h-4"></i> Explain this chart
                            </button>
                        `;

            chatMessages.appendChild(botMsg);
            feather.replace();

            // Render chart
            setTimeout(() => {
              renderSalinityChart("salinity-chart", depth, region);
            }, 100);
          } else if (message.toLowerCase().includes("compare")) {
            botMsg.innerHTML = `
                            <p>To compare data, please select two floats from the map by clicking on them and then clicking "Select for Comparison" in their popups.</p>
                            <p class="mt-2 text-sm text-gray-600">Once selected, click the "Compare" button in the top right.</p>
                        `;
            chatMessages.appendChild(botMsg);
          } else {
            botMsg.innerHTML = `
                            <p>I can help you explore ARGO float data. Try asking about:</p>
                            <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
                                <li>Temperature at specific depths</li>
                                <li>Salinity in different regions</li>
                                <li>Comparing data between floats</li>
                                <li>Uploading your own NetCDF file</li>
                            </ul>
                        `;
            chatMessages.appendChild(botMsg);
          }

          chatMessages.scrollTop = chatMessages.scrollHeight;
          feather.replace();
        }, 500);
      }

      chatInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendMessage();
      });

      sendBtn.addEventListener("click", sendMessage);

      // File upload
      document.getElementById("upload-btn").addEventListener("click", () => {
        document.getElementById("file-input").click();
      });

      document.getElementById("file-input").addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (!file) return;
        // In a real app, we'd parse the NetCDF file here
        // For demo, we'll just show a mock response
        const botMsg = document.createElement("div");
        botMsg.className = "chat-message bot rounded-lg p-3";
        botMsg.innerHTML = `
            <p>Successfully uploaded ${file.name}!</p>
            <p class="mt-2">Detected variables: TEMP, PSAL, PRES</p>
            <div class="mt-2 h-40" id="upload-chart"></div>
            <button onclick="explainChart('upload-chart')" class="mt-2 text-blue-600 text-sm flex items-center">
              <i data-feather="info" class="mr-1 w-4 h-4"></i> Explain this chart
            </button>
          `;
        chatMessages.appendChild(botMsg);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        feather.replace();
        // Render mock chart
        setTimeout(() => {
          renderUploadChart("upload-chart");
        }, 100);
      });

      // Comparison functionality
      document.getElementById("compare-btn").addEventListener("click", () => {
        if (selectedFloats.length === 2) {
          showComparison(selectedFloats[0], selectedFloats[1]);
        }
      });

      document
        .getElementById("close-comparison")
        .addEventListener("click", () => {
          document.getElementById("comparison-panel").classList.add("hidden");
          // Reset selected floats
          selectedFloats = [];
          updateComparisonUI();
          resetMarkerStyles();
        });

      // Select a float for comparison
      function selectFloat(floatId) {
        const float = floats.find((f) => f.id === floatId);
        if (!float) return;
        // ...existing code...
        const index = selectedFloats.findIndex((f) => f.id === floatId);
        if (index >= 0) {
          selectedFloats.splice(index, 1);
        } else {
          if (selectedFloats.length < 2) {
            selectedFloats.push(float);
          } else {
            selectedFloats[0] = float;
          }
        }
        updateComparisonUI();
        updateMarkerStyles();
      }

      function updateComparisonUI() {
        const compareCount = document.getElementById("compare-count");
        const compareBtn = document.getElementById("compare-btn");

        compareCount.textContent = `${selectedFloats.length}/2`;

        if (selectedFloats.length === 2) {
          compareBtn.disabled = false;
        } else {
          compareBtn.disabled = true;
        }
      }

      function updateMarkerStyles() {
        // Reset all markers
        resetMarkerStyles();
        // Highlight selected markers
        selectedFloats.forEach((float) => {
          const marker = markers.find((m) => m.floatData.id === float.id);
          if (marker && marker._icon) {
            marker._icon.classList.add("selected");
          }
        });
      }

      function resetMarkerStyles() {
        markers.forEach((marker) => {
          if (marker._icon) marker._icon.classList.remove("selected");
        });
      }

      function showComparison(float1, float2) {
        document.getElementById("comparison-panel").classList.remove("hidden");
        document.getElementById(
          "compare-title-1"
        ).textContent = `Float ${float1.id} (${float1.region})`;
        document.getElementById(
          "compare-title-2"
        ).textContent = `Float ${float2.id} (${float2.region})`;
        renderComparisonChart("compare-chart-1", float1);
        renderComparisonChart("compare-chart-2", float2);
        // ...existing code...
      }

      // Chart rendering functions
      // Show live trajectory for a float
      async function showTrajectory(floatId) {
        const trajectory = await fetchTrajectory(floatId);
        if (!trajectory || !trajectory.path) return;
        // Remove previous trajectory layer if any
        if (window.trajectoryLayer) {
          map.removeLayer(window.trajectoryLayer);
        }
        // Draw trajectory as polyline
        window.trajectoryLayer = L.polyline(trajectory.path, {
          color: "#0ea5e9",
          weight: 4,
        }).addTo(map);
        // Optionally zoom to trajectory
        map.fitBounds(window.trajectoryLayer.getBounds());
      }
      function renderTempChart(elementId, depth, region) {
        const data = [
          {
            x: [
              "Jan",
              "Feb",
              "Mar",
              "Apr",
              "May",
              "Jun",
              "Jul",
              "Aug",
              "Sep",
              "Oct",
              "Nov",
              "Dec",
            ],
            y: [
              27.5, 27.8, 28.2, 28.8, 29.5, 30.1, 29.8, 29.3, 28.9, 28.5, 28.1,
              27.7,
            ],
            type: "scatter",
            mode: "lines+markers",
            line: { color: "#ef4444" },
            name: `Temperature at ${depth}m`,
          },
        ];

        const layout = {
          margin: { t: 10, b: 30, l: 40, r: 10 },
          height: 160,
          xaxis: { title: "Month" },
          yaxis: { title: "Temperature (°C)" },
        };

        Plotly.newPlot(elementId, data, layout);
      }

      function renderSalinityChart(elementId, depth, region) {
        const data = [
          {
            x: [
              "Jan",
              "Feb",
              "Mar",
              "Apr",
              "May",
              "Jun",
              "Jul",
              "Aug",
              "Sep",
              "Oct",
              "Nov",
              "Dec",
            ],
            y: [
              35.2, 35.1, 35.0, 34.9, 34.8, 34.7, 34.8, 34.9, 35.0, 35.1, 35.2,
              35.3,
            ],
            type: "scatter",
            mode: "lines+markers",
            line: { color: "#3b82f6" },
            name: `Salinity at ${depth}m`,
          },
        ];

        const layout = {
          margin: { t: 10, b: 30, l: 40, r: 10 },
          height: 160,
          xaxis: { title: "Month" },
          yaxis: { title: "Salinity (PSU)" },
        };

        Plotly.newPlot(elementId, data, layout);
      }

      function renderUploadChart(elementId) {
        const depths = Array.from({ length: 20 }, (_, i) => i * 50);
        const temp = depths.map(
          (d) => 30 - d * 0.02 + (Math.random() * 0.5 - 0.25)
        );
        const sal = depths.map(
          (d) => 35 - d * 0.002 + (Math.random() * 0.1 - 0.05)
        );

        const data = [
          {
            x: temp,
            y: depths,
            type: "scatter",
            mode: "lines",
            name: "Temperature",
            line: { color: "#ef4444" },
            xaxis: "x1",
            yaxis: "y1",
          },
          {
            x: sal,
            y: depths,
            type: "scatter",
            mode: "lines",
            name: "Salinity",
            line: { color: "#3b82f6" },
            xaxis: "x2",
            yaxis: "y2",
          },
        ];

        const layout = {
          grid: { rows: 1, columns: 2, pattern: "independent" },
          margin: { t: 10, b: 30, l: 40, r: 40 },
          height: 160,
          xaxis: { title: "Temperature (°C)", domain: [0, 0.45] },
          xaxis2: { title: "Salinity (PSU)", domain: [0.55, 1] },
          yaxis: { title: "Depth (m)", autorange: "reversed" },
          yaxis2: { title: "Depth (m)", autorange: "reversed" },
        };

        Plotly.newPlot(elementId, data, layout);
      }

      function renderComparisonChart(elementId, float) {
        const depths = Array.from({ length: 20 }, (_, i) => i * 50);
        const temp = depths.map(
          (d) => float.temp - d * 0.02 + (Math.random() * 0.5 - 0.25)
        );
        const sal = depths.map(
          (d) => float.sal - d * 0.002 + (Math.random() * 0.1 - 0.05)
        );

        const data = [
          {
            x: temp,
            y: depths,
            type: "scatter",
            mode: "lines",
            name: "Temperature",
            line: { color: "#ef4444" },
          },
          {
            x: sal,
            y: depths,
            type: "scatter",
            mode: "lines",
            name: "Salinity",
            line: { color: "#3b82f6" },
          },
        ];

        const layout = {
          margin: { t: 30, b: 40, l: 50, r: 10 },
          height: 180,
          xaxis: { title: "Value" },
          yaxis: { title: "Depth (m)", autorange: "reversed" },
          legend: { orientation: "h", y: 1.1 },
        };

        Plotly.newPlot(elementId, data, layout);
      }

      // Explain chart function
      function explainChart(chartId) {
        let explanation = "";

        if (chartId.includes("temp")) {
          explanation = `
                    <p class="font-medium">Temperature Profile Explanation:</p>
                    <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
                        <li>Shows seasonal variation in ocean temperature</li>
                        <li>Higher temperatures in summer months (May-August)</li>
                        <li>Typical range for this region: 27-30°C</li>
                    </ul>
                `;
        } else if (chartId.includes("salinity")) {
          explanation = `
                    <p class="font-medium">Salinity Profile Explanation:</p>
                    <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
                        <li>Shows salt concentration in the ocean</li>
                        <li>Lower salinity during monsoon due to freshwater input</li>
                        <li>Typical range for this region: 34-36 PSU</li>
                    </ul>
                `;
        } else if (chartId.includes("upload")) {
          explanation = `
                    <p class="font-medium">Uploaded Data Analysis:</p>
                    <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
                        <li>Temperature decreases with depth (thermocline)</li>
                        <li>Salinity shows minor variation with depth</li>
                        <li>No significant anomalies detected</li>
                    </ul>
                `;
        } else if (chartId.includes("compare")) {
          explanation = `
                    <p class="font-medium">Comparison Insights:</p>
                    <ul class="mt-2 text-sm list-disc pl-5 space-y-1">
                        <li>Temperature profiles show similar patterns</li>
                        <li>Salinity differences may indicate freshwater influence</li>
                        <li>Depth ranges are comparable between floats</li>
                    </ul>
                `;
        }

        if (explanation) {
          const chatMessages = document.getElementById("chat-messages");
          const botMsg = document.createElement("div");
          botMsg.className = "chat-message bot rounded-lg p-3";
          botMsg.innerHTML = explanation;

          chatMessages.appendChild(botMsg);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          feather.replace();
        }
      }
    </script>
  </body>
</html>
